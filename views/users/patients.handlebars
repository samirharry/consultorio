<section class="content">
  <div class="box">
    <div class="box-body">
      <section class="content-header">
        <h1>Pacientes</h1>
      </section>
      <!-- Main content -->
      <section class="content">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins table-responsive">
                  <div class="ibox-content">
                    <table class="table">
                      <thead>
                        <tr>
                          <th>#</th>
                          <th>Apellidos y Nombres</th>
                          <th>DNI</th>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody>
                        {{#each patients}}
                          <tr>
                            <td>{{sum @index 1}}</td>
                            <td>{{apellidos}} {{nombres}}</td>
                            <td>{{dni}}</td>
                            <td><a href="/patient/{{_id}}"><button class="btn btn-info">Ver Paciente</button> </a></td>
                            <td><a href="/consult/{{_id}}"> <button class="btn btn-info">Ver Consultas</button> </a></td>
                            <td> <button class="btn btn-danger" onclick="eliminarPaciente('{{_id}}')">Eliminar Paciente</button></td>
                            <td> <button class="btn btn-warning" onclick="editarPaciente('{{_id}}')">Editar Paciente</button></td>
                          </tr>
                        {{/each}}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
        </div>
      </section>
    </div>
  </div>
</section>

<script>

  function eliminarPaciente(id){
      $.ajax({
			type: 'delete',
			url: "../patients/" + id,
			success: function(result) {
        toastr.success("Paciente borrado");
        location.reload();
			},
			error: function(xhr, ajaxOptions, thrownError){
        toastr.error("No se pudo borrar al paciente");
			}
		})
  }
</script>
